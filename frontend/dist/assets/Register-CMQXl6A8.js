import{c as Y,u as Q,l as Z,r as d,j as e,L as j}from"./index-D_NAV1yT.js";import{B as o}from"./button-Dk0LyBUq.js";import{C as _,a as G,b as K,d as X,c as ee}from"./card-DnhfeXNQ.js";import{I as x}from"./input-LIYzPJ7L.js";import{L as g,E as R,a as D,Q as te}from"./label-BXRr4-xi.js";import{A as se}from"./arrow-left-DIBwK2Ek.js";import{C as ae}from"./circle-check-big-DDw_Iq01.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=Y("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),S=({className:h="w-5 h-5"})=>e.jsx("svg",{viewBox:"0 0 24 24",className:h,fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.484 3.488"})}),pe=()=>{const h=Q(),{toast:n}=Z(),[P,F]=d.useState(!1),[C,V]=d.useState(!1),[m,c]=d.useState(!1),[r,l]=d.useState({}),[f,k]=d.useState("email"),[b,y]=d.useState(1),[A,I]=d.useState(""),[N,O]=d.useState(""),[w,W]=d.useState(300),[E,v]=d.useState(!1),[s,q]=d.useState({firstName:"",lastName:"",email:"",password:"",confirmPassword:"",phoneNumber:""});d.useEffect(()=>{let t=null;return b===2&&w>0?t=setInterval(()=>{W(a=>a<=1?(v(!0),0):a-1)},1e3):w===0&&v(!0),()=>clearInterval(t)},[b,w]);const u=t=>{const{name:a,value:i}=t.target;if(a==="otp"){const p=i.replace(/\D/g,"").slice(0,6);O(p);return}q({...s,[a]:i}),r[t.target.name]&&l({...r,[t.target.name]:""})},T=()=>{const t={};return f==="email"?(s.firstName.trim()?s.firstName.trim().length<2&&(t.firstName="First name must be at least 2 characters"):t.firstName="First name is required",s.lastName.trim()?s.lastName.trim().length<2&&(t.lastName="Last name must be at least 2 characters"):t.lastName="Last name is required",s.email?/\S+@\S+\.\S+/.test(s.email)||(t.email="Please enter a valid email address"):t.email="Email is required",s.password?s.password.length<8?t.password="Password must be at least 8 characters":/(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/.test(s.password)||(t.password="Password must contain uppercase, lowercase, and number"):t.password="Password is required",s.confirmPassword?s.password!==s.confirmPassword&&(t.confirmPassword="Passwords do not match"):t.confirmPassword="Please confirm your password"):f==="whatsapp"&&(s.phoneNumber.trim()?/^\+?[\d\s\-\(\)]{10,}$/.test(s.phoneNumber.trim())||(t.phoneNumber="Please enter a valid phone number"):t.phoneNumber="Phone number is required"),l(t),Object.keys(t).length===0},M=(t,a)=>{const i=`Hi! I want to register for bab.ai construction management platform. My verification code is: ${a}`;return`https://wa.me/+919876543210?text=${encodeURIComponent(i)}`},L=async t=>{if(t.preventDefault(),!!T()){c(!0);try{const a=Math.random().toString(36).substring(2,8).toUpperCase();I(a),await new Promise(p=>setTimeout(p,1500));const i={phoneNumber:s.phoneNumber,verificationCode:a,timestamp:new Date().toISOString(),expiresAt:new Date(Date.now()+15*60*1e3).toISOString()};localStorage.setItem("pendingWhatsAppRegistration",JSON.stringify(i)),W(300),v(!1),O(""),y(2),n({title:"WhatsApp registration initiated!",description:"Please send the message via WhatsApp to complete registration."})}catch(a){console.error("WhatsApp registration error:",a),l({general:"Failed to initiate WhatsApp registration. Please try again."}),n({variant:"destructive",title:"Error",description:"Failed to initiate WhatsApp registration."})}finally{c(!1)}}},$=async t=>{if(t.preventDefault(),!N||N.length!==6){l({otp:"Please enter a valid 6-digit OTP"});return}c(!0);try{const a=JSON.parse(localStorage.getItem("pendingWhatsAppRegistration")||"{}");if(N!==a.verificationCode){l({otp:"Invalid OTP. Please check and try again."}),n({variant:"destructive",title:"Invalid OTP",description:"The OTP you entered is incorrect."});return}if(new Date>new Date(a.expiresAt)){l({otp:"OTP has expired. Please request a new one."}),n({variant:"destructive",title:"OTP Expired",description:"Please request a new OTP."});return}await new Promise(i=>setTimeout(i,2e3)),y(3),n({title:"OTP Verified!",description:"Creating your account..."}),setTimeout(()=>{B()},1e3)}catch(a){console.error("OTP verification error:",a),l({otp:"Verification failed. Please try again."}),n({variant:"destructive",title:"Verification failed",description:"Please try again or contact support."})}finally{c(!1)}},U=async()=>{c(!0);try{const t=Math.random().toString(36).substring(2,8).toUpperCase();I(t);const a={phoneNumber:s.phoneNumber,verificationCode:t,timestamp:new Date().toISOString(),expiresAt:new Date(Date.now()+15*60*1e3).toISOString()};localStorage.setItem("pendingWhatsAppRegistration",JSON.stringify(a)),W(300),v(!1),O(""),l({}),await new Promise(i=>setTimeout(i,1e3)),n({title:"New OTP sent!",description:"A new verification code has been sent to your WhatsApp."})}catch(t){console.error("Resend OTP error:",t),n({variant:"destructive",title:"Failed to resend OTP",description:"Please try again."})}finally{c(!1)}},B=async()=>{c(!0);try{await new Promise(i=>setTimeout(i,2e3));const t={id:Date.now(),firstName:"WhatsApp",lastName:"User",phoneNumber:s.phoneNumber,email:`${s.phoneNumber.replace(/[^\d]/g,"")}@whatsapp.bab-ai.com`,registrationMethod:"whatsapp",createdAt:new Date().toISOString()},a=JSON.parse(localStorage.getItem("registeredUsers")||"[]");a.push(t),localStorage.setItem("registeredUsers",JSON.stringify(a)),localStorage.setItem("user",JSON.stringify({email:t.email,name:`${t.firstName} ${t.lastName}`,phoneNumber:t.phoneNumber,token:"whatsapp-user-token-"+Date.now()})),localStorage.removeItem("pendingWhatsAppRegistration"),y(4),n({title:"Welcome to bab.ai!",description:"Your WhatsApp registration is complete."}),setTimeout(()=>{h("/dashboard")},2e3)}catch(t){console.error("Verification error:",t),l({general:"Verification failed. Please try again."}),n({variant:"destructive",title:"Verification failed",description:"Please try again or contact support."})}finally{c(!1)}},J=async()=>{c(!0);try{await new Promise(t=>setTimeout(t,1500)),y(3),n({title:"Message sent successfully!",description:"Please enter the OTP you received to complete registration."})}catch(t){console.error("WhatsApp verification error:",t),n({variant:"destructive",title:"Verification failed",description:"Please try again."})}finally{c(!1)}},z=async t=>{if(t.preventDefault(),!!T()){c(!0);try{await new Promise(p=>setTimeout(p,2e3));const a=JSON.parse(localStorage.getItem("registeredUsers")||"[]");if(a.some(p=>p.email===s.email)){l({email:"An account with this email already exists"}),n({variant:"destructive",title:"Registration failed",description:"An account with this email already exists."});return}const i={id:Date.now(),firstName:s.firstName.trim(),lastName:s.lastName.trim(),email:s.email,createdAt:new Date().toISOString()};a.push(i),localStorage.setItem("registeredUsers",JSON.stringify(a)),localStorage.setItem("user",JSON.stringify({email:i.email,name:`${i.firstName} ${i.lastName}`,token:"user-token-"+Date.now()})),n({title:"Welcome to bab.ai!",description:"Your account has been created successfully."}),h("/dashboard")}catch(a){console.error("Registration error:",a),l({general:"Something went wrong. Please try again later."}),n({variant:"destructive",title:"Error",description:"Failed to create account. Please try again later."})}finally{c(!1)}}},H=()=>{h("/")};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs(o,{variant:"ghost",onClick:H,className:"mb-6 text-gray-600 hover:text-gray-900",children:[e.jsx(se,{className:"w-4 h-4 mr-2"}),"Back to Home"]}),e.jsxs(_,{className:"shadow-xl border-0",children:[e.jsxs(G,{className:"text-center pb-6",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-primary rounded-xl flex items-center justify-center shadow-lg",children:e.jsx("span",{className:"text-brand-white font-bold text-xl font-heading",children:"B"})}),e.jsx("div",{className:"absolute -bottom-1 -right-1 w-5 h-5 bg-gradient-to-r from-brand-accent to-brand-accent rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-brand-white text-xs font-bold font-heading",children:"ai"})})]})}),e.jsx(K,{className:"text-2xl font-bold text-gray-900",children:"Create account"}),e.jsx(X,{className:"text-gray-600",children:f==="email"?"Sign up for your bab.ai account":"Register via WhatsApp for quick access"}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsx(o,{type:"button",variant:f==="email"?"default":"outline",size:"sm",onClick:()=>{k("email"),y(1),l({})},className:"flex-1",children:"Email"}),e.jsxs(o,{type:"button",variant:f==="whatsapp"?"default":"outline",size:"sm",onClick:()=>{k("whatsapp"),l({})},className:"flex-1 bg-brand-primary hover:bg-brand-accent text-brand-white border-brand-primary",children:[e.jsx(S,{className:"w-4 h-4 mr-1"}),"WhatsApp"]})]})]}),e.jsxs(ee,{children:[r.general&&e.jsx("div",{className:"mb-4 p-3 bg-brand-white border border-brand-primary rounded-md",children:e.jsx("p",{className:"text-sm text-red-600",children:r.general})}),f==="email"?e.jsxs("form",{onSubmit:z,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"firstName",children:"First Name"}),e.jsx(x,{id:"firstName",name:"firstName",type:"text",placeholder:"John",value:s.firstName,onChange:u,required:!0,className:r.firstName?"border-red-500 focus:border-red-500":""}),r.firstName&&e.jsx("p",{className:"text-xs text-red-600",children:r.firstName})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"lastName",children:"Last Name"}),e.jsx(x,{id:"lastName",name:"lastName",type:"text",placeholder:"Doe",value:s.lastName,onChange:u,required:!0,className:r.lastName?"border-red-500 focus:border-red-500":""}),r.lastName&&e.jsx("p",{className:"text-xs text-red-600",children:r.lastName})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"email",children:"Email"}),e.jsx(x,{id:"email",name:"email",type:"email",placeholder:"john.doe@example.com",value:s.email,onChange:u,required:!0,className:`w-full ${r.email?"border-red-500 focus:border-red-500":""}`}),r.email&&e.jsx("p",{className:"text-xs text-red-600",children:r.email})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"password",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(x,{id:"password",name:"password",type:P?"text":"password",placeholder:"Create a strong password",value:s.password,onChange:u,required:!0,className:`w-full pr-10 ${r.password?"border-red-500 focus:border-red-500":""}`}),e.jsx(o,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>F(!P),children:P?e.jsx(R,{className:"h-4 w-4 text-gray-400"}):e.jsx(D,{className:"h-4 w-4 text-gray-400"})})]}),r.password&&e.jsx("p",{className:"text-xs text-red-600",children:r.password}),e.jsx("p",{className:"text-xs text-gray-500",children:"Must be 8+ characters with uppercase, lowercase, and number"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"confirmPassword",children:"Confirm Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(x,{id:"confirmPassword",name:"confirmPassword",type:C?"text":"password",placeholder:"Confirm your password",value:s.confirmPassword,onChange:u,required:!0,className:`w-full pr-10 ${r.confirmPassword?"border-red-500 focus:border-red-500":""}`}),e.jsx(o,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>V(!C),children:C?e.jsx(R,{className:"h-4 w-4 text-gray-400"}):e.jsx(D,{className:"h-4 w-4 text-gray-400"})})]}),r.confirmPassword&&e.jsx("p",{className:"text-xs text-red-600",children:r.confirmPassword})]}),e.jsxs("div",{className:"text-xs text-gray-600",children:["By creating an account, you agree to our"," ",e.jsx(o,{variant:"link",className:"px-0 text-xs text-blue-600 hover:text-blue-800 h-auto",children:"Terms of Service"})," ","and"," ",e.jsx(o,{variant:"link",onClick:()=>h("/privacy-policy"),className:"px-0 text-xs text-blue-600 hover:text-blue-800 h-auto",children:"Privacy Policy"})]}),e.jsx(o,{type:"submit",disabled:m,className:"w-full bg-gradient-primary hover:opacity-90 text-brand-white disabled:opacity-50 disabled:cursor-not-allowed font-body",children:m?e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"w-4 h-4 mr-2 animate-spin"}),"Creating Account..."]}):"Create Account"})]}):e.jsxs("div",{className:"space-y-6",children:[b===1&&e.jsxs("form",{onSubmit:L,className:"space-y-4",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("div",{className:"w-16 h-16 bg-brand-primary rounded-full flex items-center justify-center mx-auto mb-2",children:e.jsx(S,{className:"w-8 h-8 text-brand-white"})}),e.jsx("p",{className:"text-sm text-gray-600",children:"Quick registration via WhatsApp for construction professionals"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"phoneNumber",children:"Phone Number"}),e.jsx(x,{id:"phoneNumber",name:"phoneNumber",type:"tel",placeholder:"+1 (555) 123-4567",value:s.phoneNumber,onChange:u,required:!0,className:`w-full ${r.phoneNumber?"border-red-500 focus:border-red-500":""}`}),r.phoneNumber&&e.jsx("p",{className:"text-xs text-red-600",children:r.phoneNumber}),e.jsx("p",{className:"text-xs text-gray-500",children:"We'll send you a verification message via WhatsApp"})]}),e.jsx(o,{type:"submit",disabled:m,className:"w-full bg-brand-primary hover:bg-brand-accent text-brand-white disabled:opacity-50 disabled:cursor-not-allowed",children:m?e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"w-4 h-4 mr-2 animate-spin"}),"Setting up WhatsApp..."]}):e.jsxs(e.Fragment,{children:[e.jsx(S,{className:"w-4 h-4 mr-2"}),"Continue with WhatsApp"]})})]}),b===2&&e.jsxs("div",{className:"text-center space-y-6",children:[e.jsx("div",{className:"w-16 h-16 bg-brand-primary rounded-full flex items-center justify-center mx-auto",children:e.jsx(te,{className:"w-8 h-8 text-brand-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Send WhatsApp Message"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Click the button below to open WhatsApp and send the verification message"})]}),e.jsxs("div",{className:"p-4 bg-brand-white rounded-lg border border-brand-primary",children:[e.jsx("p",{className:"text-xs text-gray-600 mb-2",children:"Your verification code:"}),e.jsx("p",{className:"font-mono font-bold text-lg text-green-600",children:A})]}),e.jsxs(o,{onClick:()=>window.open(M(s.phoneNumber,A),"_blank"),className:"w-full bg-functional-success hover:bg-functional-success/90 text-brand-white font-body",children:[e.jsx(S,{className:"w-4 h-4 mr-2"}),"Open WhatsApp & Send Message"]}),e.jsxs("div",{className:"pt-4 border-t",children:[e.jsx("p",{className:"text-xs text-gray-600 mb-3",children:"Message to send:"}),e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg text-sm text-left",children:['"Hi! I want to register for bab.ai construction management platform. My verification code is:'," ",A,'"']})]}),e.jsx(o,{onClick:J,variant:"outline",className:"w-full mt-4",disabled:m,children:m?e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"w-4 h-4 mr-2 animate-spin"}),"Verifying..."]}):"I sent the message - Complete Registration"})]}),b===3&&e.jsxs("form",{onSubmit:$,className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-green-500 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(re,{className:"w-8 h-8 text-brand-white"})}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Enter Verification Code"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Please enter the 6-digit code we sent to your WhatsApp"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"enteredOtp",children:"Verification Code"}),e.jsx(x,{id:"enteredOtp",name:"enteredOtp",type:"text",placeholder:"123456",value:N,onChange:u,maxLength:6,className:`w-full text-center text-2xl font-mono tracking-wider ${r.otp?"border-red-500 focus:border-red-500":""}`,required:!0}),r.otp&&e.jsx("p",{className:"text-xs text-red-600",children:r.otp})]}),w>0&&e.jsx("div",{className:"text-center",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Resend code in"," ",e.jsxs("span",{className:"font-medium text-green-600",children:[Math.floor(w/60),":",(w%60).toString().padStart(2,"0")]})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(o,{type:"submit",className:"w-full bg-functional-success hover:bg-functional-success/90 text-brand-white font-body",disabled:m||!N||N.length!==6,children:m?e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"w-4 h-4 mr-2 animate-spin"}),"Verifying..."]}):"Verify & Complete Registration"}),E&&e.jsx(o,{type:"button",variant:"outline",className:"w-full",onClick:U,disabled:m,children:m?e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"w-4 h-4 mr-2 animate-spin"}),"Resending..."]}):"Resend Code"})]})]}),b===4&&e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx(ae,{className:"w-16 h-16 mx-auto text-green-500"}),e.jsx("h3",{className:"text-lg font-semibold text-green-600",children:"Registration Complete!"}),e.jsx("p",{className:"text-gray-600",children:"Welcome to bab.ai! Your WhatsApp registration was successful."}),e.jsx("div",{className:"p-4 bg-green-50 rounded-lg",children:e.jsx("p",{className:"text-sm text-green-600",children:"ðŸŽ‰ You can now access our construction management tools and communicate with your team via WhatsApp!"})})]})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Already have an account?"," ",e.jsx(o,{variant:"link",onClick:()=>h("/login"),className:"px-0 text-blue-600 hover:text-blue-800 font-medium",children:"Sign in"})]})})]})]})]})})};export{pe as default};
